---
title: "sample_template"
output: 
  learnr::tutorial:
    fig_caption: no
    progressive: no
    allow_skip: true
    toc: true
    toc_depth: 2
    toc_float: true
    css: "./css/custom_css.css"
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(gradethis)
library(tidyverse)
library(glue)
library(knitr)
library(reticulate)

tutorial_options(exercise.timelimit = 60, exercise.completion = FALSE, exercise.checker = gradethis::grade_learnr)
opts_chunk$set(echo = FALSE)
opts_chunk$set(comment = NA)

source <- 'Python'
target <- 'R'

source_lang_logo <- glue("<img src=\"./images/{tolower(source)}_logo.png\" class=\"language-icon\">")
target_lang_logo <- glue("<img src=\"./images/{tolower(target)}_logo.png\" class=\"language-icon\">")


knit_hooks$set(comparison = function(before, options, envir) {
    if (before) {
      heading <- glue("### {options$topic}", source_lang_logo, .sep = "\n\n")
      glue(heading, "In {source}, *FIX ME*", .sep = "\n\n")
    } else {
      heading <- glue(target_lang_logo, "In {target}, *FIX ME*", .sep="\n\n")
      r_side <- glue(heading, "```{r}", "", "```", .open="{{", .close="}}", .sep="\n")
      topic_exercise <- gsub(" ", "_", options$topic, fixed=TRUE)
      topic_exercise <- gsub("?", "", topic_exercise, fixed=TRUE)
      final <- glue(r_side, "```{r r_{{topic_exercise}}, exercise=TRUE}", "", "```", .open="{{", .close="}}", .sep="\n\n")
      fileConn<-file("file.Rmd")
      writeLines(final, fileConn)
      glue("```{r child = \"file.Rmd\"}", "```", .open="{{", .close="}}", .sep="\n\n")
    }
})

```

```{python context="data"}
# set a python variable to point to mtcars
mtcars = r.mtcars
```

<!-- # topic breakdown -->
<!-- topic <- "How do I inspect data?" -->
<!-- subtopics <- c("Print the first few rows", "Print the last few rows") -->

<!-- # code / concept comparisons per topic / subtopic -->


Test the `comparison` hook:

```{python comparison=TRUE, topic="How do I inspect data?"}
mtcars.head()
```


